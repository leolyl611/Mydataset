---
title: "My dataset"
author: "Leo Lu"
date: "2024-10-10"
output: "github_document"
---
```{r}
library(haven)
library(psych)
library(dplyr)
library(ggplot2)
library(tidyr)
library(bruceR)
library(ggsci)
library(see)
library(car)


load("/Users/leolu/Documents/38964-0001-Data.rda")

```

```{r}
mydataset <- da38964.0001 %>%
  select(SAT1, SAT2, SAT3, SAT4, SAT5, EMP_1, EMP_2, EMP_OTHER_SELFEMP, SOCIAL_2, AGE, WORK_HRS, SLEEPHRS)

mydataset$SAT1 <- as.numeric(mydataset$SAT1)

describe(mydataset$SAT1)

mydataset <- mydataset %>%
  filter(SAT1 < 6)

summary(mydataset$SAT1)

mydataset$SAT2 <- as.numeric(mydataset$SAT2)

describe(mydataset$SAT2)

mydataset <- mydataset %>%
  filter(SAT2 < 6)

summary(mydataset$SAT2)

mydataset$SAT3 <- as.numeric(mydataset$SAT3)

describe(mydataset$SAT3)

mydataset <- mydataset %>%
  filter(SAT3 < 6)

summary(mydataset$SAT3)

mydataset$SAT4 <- as.numeric(mydataset$SAT4)

describe(mydataset$SAT4)

mydataset <- mydataset %>%
  filter(SAT4 < 6)

summary(mydataset$SAT4)

mydataset$SAT5 <- as.numeric(mydataset$SAT5)

describe(mydataset$SAT5)

mydataset <- mydataset %>%
  filter(SAT5 < 6)

summary(mydataset$SAT5)

describe(mydataset$SAT5)

mydataset$SOCIAL_2 <- as.numeric(mydataset$SOCIAL_2)

describe(mydataset$SOCIAL_2)

mydataset <- mydataset %>%
  filter(SOCIAL_2 < 6)

summary(mydataset$SOCIAL_2)

describe(mydataset$SOCIAL_2)



```
```{r}

mydataset <- mydataset %>%
  filter(EMP_1 != "(99) Refusal")

mydataset <- mydataset %>%
  mutate_at(c('EMP_1'),funs(str_replace(., "(00) Item not selected", "Not in One Job")))
mydataset <- mydataset %>%  
  mutate_at(c('EMP_1'),funs(str_replace(., "(01) Item selected", "One Job")))

  summary(mydataset$EMP_1)

mydataset <- mydataset %>%
  filter(EMP_2 != "(99) Refusal")

mydataset<- mydataset%>%
  mutate_at(c('EMP_2'),funs(str_replace(., "(00) Item not selected", "Not in Multiple Jobs")))

mydataset<- mydataset%>%
  mutate_at(c('EMP_2'),funs(str_replace(., "(01) Item selected", "Multiple Jobs")))


summary(mydataset$EMP_2)

mydataset <- mydataset %>%
  filter(EMP_OTHER_SELFEMP != "(99) Refusal")

mydataset <- mydataset %>%
  mutate_at(c('EMP_OTHER_SELFEMP'),funs(str_replace(., "(00) Item not selected", "Not self employed")))

mydataset <- mydataset %>%
  mutate_at(c('EMP_OTHER_SELFEMP'),funs(str_replace(., "(01) Item selected", "Self employed")))
  
summary(mydataset$EMP_OTHER_SELFEMP)
```
```{r}

mydataset <- mydataset %>%
  mutate(SOCIAL = rowMeans(cbind(SOCIAL_2)))

mydataset$SOCIAL_log <- log10(mydataset$SOCIAL)

ggplot(mydataset, aes(x = SOCIAL_log)) + geom_histogram(binwidth = 0.25) + theme_classic()

ggplot(mydataset, aes(x = SOCIAL_log)) + geom_density(adjust = 2)  + theme_classic()

qq<-ggplot(mydataset, aes(sample = SOCIAL_log)) + geom_qq()  + theme_classic()

qq+ geom_qq_line()

mydataset %>%
  group_by(SOCIAL_log) %>%
  dplyr::summarize(mean_SOCIAL_log    = mean(SOCIAL_log),
      std_dev_SOCIAL_log = sd(SOCIAL_log),
    )

describe(mydataset$SOCIAL_log)

```



